<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聊天数据分析可视化</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #4e73df;
        }
        .header h1 {
            color: #4e73df;
            font-size: 32px;
            margin-bottom: 10px;
        }
        .header p {
            color: #6c757d;
            font-size: 16px;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-container {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            padding: 20px;
            transition: transform 0.3s ease;
            height: 450px;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }
        .chart-title {
            color: #4e73df;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eaeaea;
        }
        .chart-summary {
            font-size: 14px;
            color: #6c757d;
            margin-top: 10px;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #6c757d;
            font-size: 14px;
            padding: 20px 0;
            border-top: 1px solid #eaeaea;
        }
        .half-height {
            height: 350px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>聊天数据分析可视化</h1>
            <p>数据区间：2024年6月8日 - 2025年7月31日</p>
            <p>生成时间：2025年8月12日 15时41分36秒</p>
	    <a href="wechatpsge.html">聊天界面</a>
        </div>
        
        <div class="chart-grid">
            <div class="chart-container">
                <div class="chart-title">月度消息量对比</div>
                <div id="monthlyChart" style="height: 350px;"></div>
                <div class="chart-summary">
                    <p>· NOIR 总消息数: <strong>23,246</strong> | if 总消息数: <strong>20,807</strong></p>
                    <p>· 最高月: 2024年7月 (NOIR: 4,061条, if: 3,247条)</p>
                    <p>· 最低月: 2025年7月 (NOIR: 630条, if: 599条)</p>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">活跃时段分布（热力图）</div>
                <div id="hourWeekChart" style="height: 350px;"></div>
                <div class="chart-summary">
                    <p>· 最活跃时段: <strong>0时</strong> (9,867条) | 最活跃星期: <strong>星期二</strong> (7,688条)</p>
                    <p>· 最冷清时段: <strong>5时</strong> (93条) | 最冷清星期: <strong>星期六</strong> (3,569条)</p>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">情感分布分析</div>
                <div id="sentimentChart" style="height: 350px;"></div>
                <div class="chart-summary">
                    <p>· 整体中性消息占比: <strong>88.9%</strong></p>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">高频关键词分布</div>
                <div id="keywordChart" style="height: 350px;"></div>
                <div class="chart-summary">
                    <p>· 最常用词语: "<strong>宝贝</strong>" (1,312次)</p>
                    <p>· 情感相关高频词: "喜欢" (827次), "晚安" (514次), "不要" (496次)</p>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">参与者对话占比</div>
                <div id="userShareChart" style="height: 350px;"></div>
                <div class="chart-summary">
                    <p>· NOIR 发言占比: <strong>52.8%</strong> | if 发言占比: <strong>47.2%</strong></p>
                    <p>· 总消息数: <strong>44,053</strong> 条</p>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">个人常用关键词TOP5</div>
                <div id="userKeywordsChart" style="height: 350px;"></div>
                <div class="chart-summary">
                    <p>· if的关键词: 宝贝, 知道, 捂脸, 撤回, 一条</p>
                    <p>· NOIR的关键词: 宝贝, 宝宝, 没有, 喜欢, 真的</p>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>数据分析报告 © 2025 | 数据来源: 聊天历史记录 | 统计方法: 基于Python的自然语言处理分析</p>
        </div>
    </div>

    <script>
        // 初始化ECharts实例
        const monthlyChart = echarts.init(document.getElementById('monthlyChart'));
        const hourWeekChart = echarts.init(document.getElementById('hourWeekChart'));
        const sentimentChart = echarts.init(document.getElementById('sentimentChart'));
        const keywordChart = echarts.init(document.getElementById('keywordChart'));
        const userShareChart = echarts.init(document.getElementById('userShareChart'));
        const userKeywordsChart = echarts.init(document.getElementById('userKeywordsChart'));
        
        // 1. 月度消息量对比
        const monthlyOption = {
            tooltip: {
                trigger: 'axis',
                formatter: '{b}<br/>{a0}: {c0}条<br/>{a1}: {c1}条'
            },
            legend: {
                data: ['NOIR', 'if'],
                bottom: 10
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '15%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: ['2024-06', '2024-07', '2024-08', '2024-09', '2024-10', '2024-11', 
                       '2024-12', '2025-01', '2025-02', '2025-03', '2025-04', '2025-05', '2025-06', '2025-07'],
                axisLabel: {
                    rotate: 45
                }
            },
            yAxis: {
                type: 'value',
                name: '消息数量'
            },
            series: [
                {
                    name: 'NOIR',
                    type: 'bar',
                    data: [2656, 4061, 1378, 1996, 1505, 838, 1232, 1221, 1112, 1610, 1926, 1629, 1449, 630],
                    itemStyle: {color: '#4e73df'}
                },
                {
                    name: 'if',
                    type: 'bar',
                    data: [2154, 3247, 1384, 2153, 1367, 788, 1269, 1084, 980, 1412, 1534, 1291, 1544, 599],
                    itemStyle: {color: '#1cc88a'}
                }
            ]
        };
        
        // 2. 活跃时段热力图
        const weekdays = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期日'];
        const hours = Array.from({length: 24}, (_, i) => i + '时');
        const heatData = [
            [1578,1258,541,421,220,86,14,12,113,180,172,108,167,106,197,173,160,145,175,197,300,161,250,833],
            [1994,1569,528,78,0,0,6,7,101,122,225,166,201,172,151,162,298,283,172,223,176,170,251,633],
            [1657,1136,354,180,24,0,2,24,100,82,192,206,323,191,139,226,160,217,171,204,176,187,221,945],
            [1602,1194,243,24,7,3,5,53,99,127,135,162,177,126,212,102,239,145,182,144,279,275,237,550],
            [1909,1988,822,47,1,0,5,17,65,73,166,174,183,335,88,203,203,177,178,194,103,70,175,389],
            [643,752,358,176,41,1,1,5,4,43,56,105,101,95,59,57,122,236,69,68,97,73,109,298],
            [484,441,340,111,20,3,10,1,39,31,107,105,82,90,90,159,148,91,193,283,208,211,255,723]
        ];
        let heatmapData = [];
        for (let i = 0; i < 7; i++) {
            for (let j = 0; j < 24; j++) {
                heatmapData.push([j, i, heatData[i][j]]);
            }
        }
        const heatmapOption = {
            tooltip: {
                position: 'top',
                formatter: function(params) {
                    return weekdays[params.value[1]] + '<br>' 
                        + params.value[0] + '时<br>消息数: ' + params.value[2];
                }
            },
            grid: {
                top: 40,
                bottom: 40,
                left: 60,
                right: 20
            },
            xAxis: {
                type: 'category',
                data: hours,
                position: 'top',
                axisLabel: {
                    interval: 0
                }
            },
            yAxis: {
                type: 'category',
                data: weekdays,
                axisLabel: {
                    interval: 0
                }
            },
            visualMap: {
                min: 0,
                max: 2000,
                calculable: true,
                orient: 'vertical',
                left: 'right',
                top: 'center',
                inRange: {
                    color: ['#d6eaff', '#1890ff', '#0050b3']
                }
            },
            series: [{
                name: '消息数',
                type: 'heatmap',
                data: heatmapData,
                emphasis: {
                    itemStyle: {
                        shadowBlur: 10,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }]
        };
        
        // 3. 情感分布分析
        const sentimentOption = {
            tooltip: {
                trigger: 'item',
                formatter: '{b}: {c}条 ({d}%)'
            },
            legend: {
                bottom: 10,
                data: ['中性', '积极', '消极']
            },
            color: ['#858796', '#1cc88a', '#e74a3b'],
            series: [
                {
                    name: '情感分布',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '18',
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        {value: 39257, name: '中性'},
                        {value: 4347, name: '积极'},
                        {value: 449, name: '消极'}
                    ]
                }
            ]
        };
        
        // 4. 高频关键词分布
        const keywords = ['宝贝', '宝宝', '喜欢', '知道', '真的', '感觉', '自己', '可以', '还是', '觉得', '现在', '晚安', '不要'];
        const keywordCounts = [1312, 1065, 827, 696, 690, 688, 668, 666, 660, 615, 583, 514, 496];
        const keywordOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                name: '出现频次'
            },
            yAxis: {
                type: 'category',
                data: keywords,
                name: '关键词'
            },
            series: [
                {
                    name: '出现频次',
                    type: 'bar',
                    data: keywordCounts,
                    itemStyle: {
                        color: function(params) {
                            return params.value > 1000 ? '#4e73df' : 
                                   params.value > 700 ? '#36b9cc' : 
                                   params.value > 500 ? '#1cc88a' : '#f6c23e';
                        }
                    },
                    label: {
                        show: true,
                        position: 'right'
                    }
                }
            ]
        };
        
        // 5. 参与者对话占比
        const userShareOption = {
            tooltip: {
                trigger: 'item',
                formatter: '{b}: {c}条 ({d}%)'
            },
            legend: {
                orient: 'vertical',
                right: 10,
                top: 'center',
                data: ['NOIR', 'if']
            },
            color: ['#4e73df', '#1cc88a'],
            series: [
                {
                    name: '发言占比',
                    type: 'pie',
                    radius: '50%',
                    center: ['40%', '50%'],
                    data: [
                        {value: 23246, name: 'NOIR'},
                        {value: 20807, name: 'if'}
                    ],
                    emphasis: {
                        itemStyle: {
                            shadowBlir: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    },
                    label: {
                        formatter: '{b}: {c}条 ({d}%)'
                    }
                }
            ]
        };
        
        // 6. 个人常用关键词TOP5（修正过的部分）
        const ifKeywords = ['宝贝', '知道', '捂脸', '撤回', '一条'];
        const noirKeywords = ['宝贝', '宝宝', '没有', '喜欢', '真的'];
        const userKeywordsOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                },
                formatter: function(params) {
                    return params[0].name + '<br/>' + 
                           params[0].seriesName + ': ' + params[0].value + '次<br/>' + 
                           params[1].seriesName + ': ' + params[1].value + '次';
                }
            },
            legend: {
                data: ['if', 'NOIR'],
                bottom: 10
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '15%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: ['TOP1', 'TOP2', 'TOP3', 'TOP4', 'TOP5'],
                name: '关键词排名'
            },
            yAxis: {
                type: 'value',
                name: '使用频次'
            },
            series: [
                {
                    name: 'if',
                    type: 'bar',
                    data: [361, 349, 335, 324, 322],
                    itemStyle: {color: '#1cc88a'},
                    label: {
                        show: true,
                        position: 'top',
                        formatter: function(params) {
                            return ifKeywords[params.dataIndex];
                        }
                    }
                },
                {
                    name: 'NOIR',
                    type: 'bar',
                    data: [884, 757, 549, 421, 369],
                    itemStyle: {color: '#4e73df'},
                    label: {
                        show: true,
                        position: 'top',
                        formatter: function(params) {
                            return noirKeywords[params.dataIndex];
                        }
                    }
                }
            ]
        };
        
        // 设置图表选项
        monthlyChart.setOption(monthlyOption);
        hourWeekChart.setOption(heatmapOption);
        sentimentChart.setOption(sentimentOption);
        keywordChart.setOption(keywordOption);
        userShareChart.setOption(userShareOption);
        userKeywordsChart.setOption(userKeywordsOption);
        
        // 响应窗口调整大小
        window.addEventListener('resize', function() {
            monthlyChart.resize();
            hourWeekChart.resize();
            sentimentChart.resize();
            keywordChart.resize();
            userShareChart.resize();
            userKeywordsChart.resize();
        });
    </script>
</body>
</html>
