<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠå¤©æ•°æ®åˆ†æå¯è§†åŒ–</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.0.0/dist/echarts-wordcloud.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            padding: 20px;
            min-height: 100vh;
        }
        
        header {
            text-align: center;
            padding: 20px 0 30px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #a0a0b0;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            max-width: 1300px;
            margin: 0 auto;
        }
        
        .chart-container {
            background: rgba(30, 30, 46, 0.7);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(4px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 400px;
        }
        
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }
        
        .chart-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            color: #feb47b;
        }
        
        .chart-title i {
            margin-right: 10px;
            font-size: 1.5rem;
        }
        
        .chart {
            width: 100%;
            height: calc(100% - 40px);
        }
        
        .double-chart {
            grid-column: span 2;
            height: 450px;
        }
        
        .summary-container {
            grid-column: span 2;
            background: rgba(30, 30, 46, 0.7);
            border-radius: 15px;
            padding: 25px;
            margin-top: 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(4px);
        }
        
        .summary-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #ff7e5f;
            text-align: center;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .participant {
            background: rgba(40, 40, 60, 0.5);
            border-radius: 10px;
            padding: 20px;
        }
        
        .participant-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 12px;
            margin-bottom: 15px;
        }
        
        .participant-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #64b5f6;
        }
        
        .message-count {
            font-size: 1.1rem;
            color: #81c784;
        }
        
        .topic-list {
            list-style: none;
        }
        
        .topic-list li {
            padding: 8px 0;
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.07);
        }
        
        .topic-text {
            color: #e0e0e0;
        }
        
        .topic-count {
            color: #ffb74d;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            color: #a0a0b0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }
        
        @media (max-width: 1250px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            .double-chart {
                grid-column: span 1;
            }
            .summary-container {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>èŠå¤©æ•°æ®åˆ†æå¯è§†åŒ–</h1>
        <p class="subtitle">èŠå¤©æ•°æ®å¤šç»´åº¦åˆ†æ (2024å¹´6æœˆ8æ—¥ - 2025å¹´7æœˆ31æ—¥)</p>
        <a href="wechatpsge.html" target="_blank">åœ¨ç–²æƒ«çš„æ—¥å­é‡Œæ€»è¦åšä¸€äº›æ¸©æŸ”çš„æ¢¦ï¼Œæ¯”å¦‚æˆ‘å¾ˆæƒ³ä½ </a>
    </header>
    
    <div class="dashboard">
        <div class="chart-container double-chart">
            <div class="chart-title"><i>ğŸ“…</i> å‚ä¸è€…æ¶ˆæ¯æ—¶é—´åˆ†å¸ƒ</div>
            <div id="timeDistribution" class="chart"></div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title"><i>ğŸ‰</i> æƒ…æ„Ÿåˆ†æç»“æœ</div>
            <div id="sentimentAnalysis" class="chart"></div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title"><i>â°</i> èŠå¤©æ—¶æ®µåˆ†å¸ƒ</div>
            <div id="timeHeatmap" class="chart"></div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title"><i>ğŸ“Š</i> é«˜é¢‘ä¸»é¢˜è¯äº‘</div>
            <div id="wordCloud" class="chart"></div>
        </div>
        
        <div class="summary-container">
            <div class="summary-title">å¯¹è¯äº’åŠ¨åˆ†ææ‘˜è¦</div>
            <div class="summary-grid">
                <div class="participant">
                    <div class="participant-header">
                        <div class="participant-name">if</div>
                        <div class="message-count">å‘è¨€æ¡æ•°ï¼š20,807</div>
                    </div>
                    <div class="participant-body">
                        <p><strong>å‘è¨€å æ¯”ï¼š</strong> <span style="color:#64ffda">47.2%</span></p>
                        <p><strong>æœ€å¸¸è®¨è®ºä¸»é¢˜ï¼š</strong></p>
                        <ul class="topic-list">
                            <li><span class="topic-text">å®è´</span><span class="topic-count">361æ¬¡</span></li>
                            <li><span class="topic-text">çŸ¥é“</span><span class="topic-count">349æ¬¡</span></li>
                            <li><span class="topic-text">æ‚è„¸</span><span class="topic-count">335æ¬¡</span></li>
                            <li><span class="topic-text">æ’¤å›</span><span class="topic-count">324æ¬¡</span></li>
                            <li><span class="topic-text">ä¸€æ¡</span><span class="topic-count">322æ¬¡</span></li>
                        </ul>
                        <p style="margin-top:15px"><strong>æ¶ˆæ¯æƒ…æ„Ÿï¼š</strong> <span style="color:#ffb74d">ä¸­æ€§ä¸ºä¸» (89.9%)</span></p>
                    </div>
                </div>
                
                <div class="participant">
                    <div class="participant-header">
                        <div class="participant-name">NOIR</div>
                        <div class="message-count">å‘è¨€æ¡æ•°ï¼š23,246</div>
                    </div>
                    <div class="participant-body">
                        <p><strong>å‘è¨€å æ¯”ï¼š</strong> <span style="color:#64ffda">52.8%</span></p>
                        <p><strong>æœ€å¸¸è®¨è®ºä¸»é¢˜ï¼š</strong></p>
                        <ul class="topic-list">
                            <li><span class="topic-text">å®è´</span><span class="topic-count">884æ¬¡</span></li>
                            <li><span class="topic-text">å®å®</span><span class="topic-count">757æ¬¡</span></li>
                            <li><span class="topic-text">æ²¡æœ‰</span><span class="topic-count">549æ¬¡</span></li>
                            <li><span class="topic-text">å–œæ¬¢</span><span class="topic-count">421æ¬¡</span></li>
                            <li><span class="topic-text">çœŸçš„</span><span class="topic-count">369æ¬¡</span></li>
                        </ul>
                        <p style="margin-top:15px"><strong>æ¶ˆæ¯æƒ…æ„Ÿï¼š</strong> <span style="color:#ffb74d">ä¸­æ€§ä¸ºä¸» (88.4%)</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>æ•°æ®æ—¶é—´èŒƒå›´ï¼š2024å¹´6æœˆ8æ—¥ - 2025å¹´7æœˆ31æ—¥ | åˆ†ææ—¶é—´ï¼š2025å¹´8æœˆ12æ—¥</p>
        <p>Â© 2025 èŠå¤©æ•°æ®åˆ†æç³»ç»Ÿ | å¯è§†åŒ–å±•ç¤º</p>
    </footer>

    <script>
        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        document.addEventListener('DOMContentLoaded', function() {
            // æ¶ˆæ¯æ—¶é—´åˆ†å¸ƒæŸ±çŠ¶å›¾
            const timeDistChart = echarts.init(document.getElementById('timeDistribution'));
            const timeDistOption = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(40, 40, 60, 0.9)',
                    borderColor: '#777',
                    textStyle: { color: '#fff' },
                    formatter: '{b}<br/>{a}: {c}æ¡æ¶ˆæ¯'
                },
                legend: {
                    data: ['NOIR', 'if'],
                    textStyle: { color: '#ccc' },
                    right: '5%'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    top: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['2024-06', '2024-07', '2024-08', '2024-09', '2024-10', '2024-11', 
                           '2024-12', '2025-01', '2025-02', '2025-03', '2025-04', '2025-05', '2025-06', '2025-07'],
                    axisLine: { lineStyle: { color: '#777' } },
                    axisLabel: { color: '#aaa', rotate: 45 }
                },
                yAxis: {
                    type: 'value',
                    name: 'æ¶ˆæ¯æ•°é‡',
                    nameTextStyle: { color: '#aaa' },
                    axisLine: { show: true, lineStyle: { color: '#777' } },
                    splitLine: { lineStyle: { color: 'rgba(255,255,255,0.1)' } },
                    axisLabel: { color: '#aaa' }
                },
                series: [
                    {
                        name: 'NOIR',
                        type: 'bar',
                        data: [2656, 4061, 1378, 1996, 1505, 838, 1232, 1221, 1112, 1610, 1926, 1629, 1449, 630],
                        itemStyle: { color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#83bff6' },
                            { offset: 1, color: '#188df0' }
                        ]) },
                        emphasis: {
                            itemStyle: { color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: '#8dc1ff' },
                                { offset: 1, color: '#1e90ff' }
                            ]) }
                        }
                    },
                    {
                        name: 'if',
                        type: 'bar',
                        data: [2154, 3247, 1384, 2153, 1367, 788, 1269, 1084, 980, 1412, 1534, 1291, 1544, 599],
                        itemStyle: { color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#ff9f7f' },
                            { offset: 1, color: '#f86c6b' }
                        ]) },
                        emphasis: {
                            itemStyle: { color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: '#ffaa8f' },
                                { offset: 1, color: '#ff6b6b' }
                            ]) }
                        }
                    }
                ]
            };
            timeDistChart.setOption(timeDistOption);
            
            // æƒ…æ„Ÿåˆ†æé¥¼å›¾
            const sentimentChart = echarts.init(document.getElementById('sentimentAnalysis'));
            const sentimentOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} ({d}%)',
                    backgroundColor: 'rgba(40, 40, 60, 0.9)',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    orient: 'vertical',
                    right: 10,
                    top: 'center',
                    textStyle: { color: '#ccc' }
                },
                series: [{
                    name: 'æƒ…æ„Ÿåˆ†å¸ƒ',
                    type: 'pie',
                    radius: ['35%', '70%'],
                    center: ['40%', '50%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#1a1a2e',
                        borderWidth: 2
                    },
                    label: {
                        show: true,
                        formatter: '{b}: {d}%',
                        color: '#e6e6e6'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '18',
                            fontWeight: 'bold'
                        }
                    },
                    data: [
                        { value: 39257, name: 'ä¸­æ€§', itemStyle: { color: '#64b5f6' } },
                        { value: 4347, name: 'ç§¯æ', itemStyle: { color: '#81c784' } },
                        { value: 449, name: 'æ¶ˆæ', itemStyle: { color: '#ff6b6b' } }
                    ]
                }]
            };
            sentimentChart.setOption(sentimentOption);
            
            // èŠå¤©æ—¶æ®µçƒ­åŠ›å›¾
            const heatmapChart = echarts.init(document.getElementById('timeHeatmap'));
            const heatmapOption = {
                tooltip: {
                    position: 'top',
                    formatter: function (params) {
                        return 'æ˜ŸæœŸ' + params.value[0] + '<br>' 
                            + params.value[1] + '<br>'
                            + 'æ¶ˆæ¯æ•°: ' + params.value[2];
                    },
                    backgroundColor: 'rgba(40, 40, 60, 0.9)',
                    textStyle: { color: '#fff' }
                },
                grid: {
                    left: '5%',
                    right: '10%',
                    bottom: '15%',
                    top: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['0~2', '2~4', '4~6', '6~8', '8~10', '10~12', 
                           '12~14', '14~16', '16~18', '18~20', '20~22', '22~24'],
                    position: 'top',
                    axisLine: { lineStyle: { color: '#777' } },
                    axisLabel: { color: '#aaa', interval: 0 }
                },
                yAxis: {
                    type: 'category',
                    data: ['æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­', 'æ˜ŸæœŸæ—¥'],
                    inverse: true,
                    axisLine: { lineStyle: { color: '#777' } },
                    axisLabel: { color: '#aaa' }
                },
                visualMap: {
                    min: 0,
                    max: 4000,
                    calculable: true,
                    orient: 'vertical',
                    right: '3%',
                    top: 'center',
                    textStyle: { color: '#ccc' },
                    inRange: {
                        color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#fee090', '#fdae61', '#f46d43', '#d73027']
                    }
                },
                series: [{
                    name: 'æ¶ˆæ¯æ•°é‡',
                    type: 'heatmap',
                    data: [
                        [0, 0, 2836], [1, 0, 962], [2, 0, 306], [3, 0, 26], [4, 0, 293], [5, 0, 280], [6, 0, 273], [7, 0, 370], [8, 0, 305], [9, 0, 372], [10, 0, 461], [11, 0, 1083],
                        [0, 1, 3563], [1, 1, 606], [2, 1, 0], [3, 1, 13], [4, 1, 223], [5, 1, 391], [6, 1, 373], [7, 1, 313], [8, 1, 581], [9, 1, 395], [10, 1, 346], [11, 1, 884],
                        [0, 2, 2793], [1, 2, 534], [2, 2, 24], [3, 2, 26], [4, 2, 182], [5, 2, 398], [6, 2, 514], [7, 2, 365], [8, 2, 377], [9, 2, 375], [10, 2, 363], [11, 2, 1166],
                        [0, 3, 2796], [1, 3, 267], [2, 3, 10], [3, 3, 58], [4, 3, 226], [5, 3, 297], [6, 3, 303], [7, 3, 314], [8, 3, 384], [9, 3, 326], [10, 3, 554], [11, 3, 787],
                        [0, 4, 3897], [1, 4, 869], [2, 4, 1], [3, 4, 22], [4, 4, 138], [5, 4, 340], [6, 4, 518], [7, 4, 291], [8, 4, 380], [9, 4, 372], [10, 4, 173], [11, 4, 564],
                        [0, 5, 1395], [1, 5, 534], [2, 5, 42], [3, 5, 6], [4, 5, 47], [5, 5, 161], [6, 5, 196], [7, 5, 116], [8, 5, 358], [9, 5, 137], [10, 5, 170], [11, 5, 407],
                        [0, 6, 925], [1, 6, 451], [2, 6, 23], [3, 6, 11], [4, 6, 70], [5, 6, 212], [6, 6, 172], [7, 6, 249], [8, 6, 239], [9, 6, 476], [10, 6, 419], [11, 6, 978]
                    ],
                    label: {
                        show: false
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };
            heatmapChart.setOption(heatmapOption);
            
            // ä¿®å¤è¯äº‘å›¾
            const wordCloudChart = echarts.init(document.getElementById('wordCloud'));
            const wordData = [
                { name: 'å®è´', value: 1312 },
                { name: 'å®å®', value: 1065 },
                { name: 'å–œæ¬¢', value: 827 },
                { name: 'çŸ¥é“', value: 696 },
                { name: 'çœŸçš„', value: 690 },
                { name: 'æ„Ÿè§‰', value: 688 },
                { name: 'è‡ªå·±', value: 668 },
                { name: 'å¯ä»¥', value: 666 },
                { name: 'è¿˜æ˜¯', value: 660 },
                { name: 'è§‰å¾—', value: 615 },
                { name: 'ç°åœ¨', value: 583 },
                { name: 'æ™šå®‰', value: 514 },
                { name: 'ä¸è¦', value: 496 }
            ];
            
            const wordCloudOption = {
                tooltip: {
                    show: true,
                    formatter: function(params) {
                        return params.name + ': ' + params.value;
                    },
                    backgroundColor: 'rgba(40, 40, 60, 0.9)',
                    textStyle: { color: '#fff' }
                },
                series: [{
                    type: 'wordCloud',
                    sizeRange: [15, 70],
                    rotationRange: [0, 0],
                    shape: 'circle',
                    layoutAnimation: true,
                    textStyle: {
                        fontFamily: 'sans-serif',
                        fontWeight: 'bold',
                        color: function () {
                            // éšæœºä½†é²œè‰³çš„é¢œè‰²
                            return 'rgb(' + [
                                Math.round(Math.random() * 100 + 155),
                                Math.round(Math.random() * 100 + 155),
                                Math.round(Math.random() * 100 + 155)
                            ].join(',') + ')';
                        }
                    },
                    emphasis: {
                        focus: 'self',
                        textStyle: {
                            shadowBlur: 10,
                            shadowColor: '#333'
                        }
                    },
                    data: wordData
                }]
            };
            
            wordCloudChart.setOption(wordCloudOption);
            
            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function() {
                timeDistChart.resize();
                sentimentChart.resize();
                heatmapChart.resize();
                wordCloudChart.resize();
            });
        });
    </script>
</body>
</html>
